import{d as fe,s as G,h as ee,y as Te,R as Le,at as Pe,b as c,I as W,w,T as ze,as as We,o as l,aj as Ve,ak as Oe,j as ue,r as K,c as N,D as te,e as E,E as R,J as de,n as we,t as _e,F as J,P as Me,a as ie,b3 as Ye,b4 as Ke,a6 as Re,k as C,M as Y,av as he,W as ye,ax as ke,v as qe,am as Je,ad as Xe}from"./framework.DXFcsTCa.js";import{p as Ze,q as Ge}from"./theme.BETrrxB7.js";import{i as Qe,r as xe,f as et,s as tt}from"./aria.D_avW3zq.js";import{o as ce,a as nt,_ as rt}from"./index.CPEHL3hC.js";import{i as ot,a as at,b as lt,c as st,g as ut,d as it,e as ct}from"./baseClone.CDMU4uBC.js";import{i as dt}from"./MapCache.DYAvTFHB.js";import{u as ft}from"./useFullscreen.XEBWjjty.js";import{c as De,u as mt}from"./useForm.DwieLnI6.js";import{i as Be,u as pt}from"./useTable.fdNC2tzx.js";/* empty css              */const ht={class:"u-context-menu__list"},yt=["onClick"],vt={class:"u-context-menu-item__label"},Ae=fe({name:"UContextMenu",__name:"context-menu",props:{triggerSelectors:{},afterClickHide:{type:Boolean,default:!0},offsetX:{default:0},offsetY:{default:0},manual:{type:Boolean,default:!1},items:{default:()=>[]}},emits:["show","hide","select"],setup(s,{expose:y,emit:V}){const v=s,b=V,B=G(),A=G(!1),t=G({top:100,left:100}),j=ee(()=>({top:`${t.value.top}px`,left:`${t.value.left}px`,visibility:A.value?"visible":"hidden"})),U=D=>{const{pageX:H,pageY:P,clientX:k,clientY:F}=D,u=window.innerWidth,f=window.innerHeight,d=B.value;if(!d)return{top:0,left:0};const{offsetWidth:_,offsetHeight:S}=d,g=k+_>u?H-_+v.offsetX:H+v.offsetX;return{top:F+S>f?P-S+v.offsetY:P+v.offsetY,left:g}},q=D=>{const H=D.target;if(!H){console.warn("无效的事件目标");return}(!v.triggerSelectors||H.closest(v.triggerSelectors)!==null)&&(D.preventDefault(),t.value=U(D),A.value=!0,b("show"),document.addEventListener("click",M))},M=D=>{const H=D.target;!v.afterClickHide&&H.closest(".u-context-menu")||(A.value=!1,b("hide"),document.removeEventListener("click",M))},X=D=>{b("select",D)};return Te(()=>{v.manual||Le(()=>{document.addEventListener("contextmenu",q)})}),Pe(()=>{document.removeEventListener("contextmenu",q),document.removeEventListener("click",M)}),y({showMenu:q,hideMenu:M}),(D,H)=>{const P=R("el-icon");return l(),c(We,{to:"body"},[W(ze,{name:"u-context-menu"},{default:w(()=>[Ve(ue("div",{ref_key:"contextMenuRef",ref:B,class:"u-context-menu",style:Me(j.value)},[K(D.$slots,"default",{},()=>[ue("ul",ht,[(l(!0),N(J,null,te(D.items,k=>(l(),N("li",{key:k.name,class:"u-context-menu-item",onClick:F=>X(k)},[k.icon?(l(),c(P,{key:0,class:"u-context-menu-item__icon"},{default:w(()=>[(l(),c(de(k.icon)))]),_:2},1024)):E("",!0),k.iconClass?(l(),N("i",{key:1,class:we(["u-context-menu-item__icon",k.iconClass])},null,2)):E("",!0),ue("span",vt,_e(k.label),1)],8,yt))),128))])])],4),[[Oe,A.value]])]),_:3})])}}}),Fe=Ae;Fe.install=s=>{s.component("UContextMenu",Ae)};const gt=(s,y="children")=>{const V=[],v=b=>{b.forEach(B=>{V.push(B),B!=null&&B[y]&&v(B[y])})};return v(s),V},ve=(s,y,V={})=>{var B;if(y==null)return"";if(Array.isArray(y))return y.map(A=>Array.isArray(A)?A.map(t=>ve(s,t,V)).join("/"):ve(s,A,V)).join("、");const v=V.label||"label",b=V.value||"value";return((B=s.find(A=>A[b]===y))==null?void 0:B[v])??y};var bt="[object Map]",kt="[object Set]",$t=Object.prototype,wt=$t.hasOwnProperty;function $e(s){if(s==null)return!0;if(ot(s)&&(dt(s)||typeof s=="string"||typeof s.splice=="function"||at(s)||lt(s)||st(s)))return!s.length;var y=ut(s);if(y==bt||y==kt)return!s.size;if(it(s))return!ct(s).length;for(var V in s)if(wt.call(s,V))return!1;return!0}var Ue={exports:{}};(function(s,y){(function(V,v){s.exports=v()})(Ge,function(){var V=1e3,v=6e4,b=36e5,B="millisecond",A="second",t="minute",j="hour",U="day",q="week",M="month",X="quarter",D="year",H="date",P="Invalid Date",k=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,F=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,u={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(a){var r=["th","st","nd","rd"],e=a%100;return"["+a+(r[(e-20)%10]||r[e]||r[0])+"]"}},f=function(a,r,e){var n=String(a);return!n||n.length>=r?a:""+Array(r+1-n.length).join(e)+a},d={s:f,z:function(a){var r=-a.utcOffset(),e=Math.abs(r),n=Math.floor(e/60),o=e%60;return(r<=0?"+":"-")+f(n,2,"0")+":"+f(o,2,"0")},m:function a(r,e){if(r.date()<e.date())return-a(e,r);var n=12*(e.year()-r.year())+(e.month()-r.month()),o=r.clone().add(n,M),p=e-o<0,h=r.clone().add(n+(p?-1:1),M);return+(-(n+(e-o)/(p?o-h:h-o))||0)},a:function(a){return a<0?Math.ceil(a)||0:Math.floor(a)},p:function(a){return{M,y:D,w:q,d:U,D:H,h:j,m:t,s:A,ms:B,Q:X}[a]||String(a||"").toLowerCase().replace(/s$/,"")},u:function(a){return a===void 0}},_="en",S={};S[_]=u;var g="$isDayjsObject",T=function(a){return a instanceof ne||!(!a||!a[g])},I=function a(r,e,n){var o;if(!r)return _;if(typeof r=="string"){var p=r.toLowerCase();S[p]&&(o=p),e&&(S[p]=e,o=p);var h=r.split("-");if(!o&&h.length>1)return a(h[0])}else{var i=r.name;S[i]=r,o=i}return!n&&o&&(_=o),o||!n&&_},m=function(a,r){if(T(a))return a.clone();var e=typeof r=="object"?r:{};return e.date=a,e.args=arguments,new ne(e)},$=d;$.l=I,$.i=T,$.w=function(a,r){return m(a,{locale:r.$L,utc:r.$u,x:r.$x,$offset:r.$offset})};var ne=function(){function a(e){this.$L=I(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[g]=!0}var r=a.prototype;return r.parse=function(e){this.$d=function(n){var o=n.date,p=n.utc;if(o===null)return new Date(NaN);if($.u(o))return new Date;if(o instanceof Date)return new Date(o);if(typeof o=="string"&&!/Z$/i.test(o)){var h=o.match(k);if(h){var i=h[2]-1||0,L=(h[7]||"0").substring(0,3);return p?new Date(Date.UTC(h[1],i,h[3]||1,h[4]||0,h[5]||0,h[6]||0,L)):new Date(h[1],i,h[3]||1,h[4]||0,h[5]||0,h[6]||0,L)}}return new Date(o)}(e),this.init()},r.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},r.$utils=function(){return $},r.isValid=function(){return this.$d.toString()!==P},r.isSame=function(e,n){var o=m(e);return this.startOf(n)<=o&&o<=this.endOf(n)},r.isAfter=function(e,n){return m(e)<this.startOf(n)},r.isBefore=function(e,n){return this.endOf(n)<m(e)},r.$g=function(e,n,o){return $.u(e)?this[n]:this.set(o,e)},r.unix=function(){return Math.floor(this.valueOf()/1e3)},r.valueOf=function(){return this.$d.getTime()},r.startOf=function(e,n){var o=this,p=!!$.u(n)||n,h=$.p(e),i=function(le,Q){var oe=$.w(o.$u?Date.UTC(o.$y,Q,le):new Date(o.$y,Q,le),o);return p?oe:oe.endOf(U)},L=function(le,Q){return $.w(o.toDate()[le].apply(o.toDate("s"),(p?[0,0,0,0]:[23,59,59,999]).slice(Q)),o)},z=this.$W,O=this.$M,Z=this.$D,re="set"+(this.$u?"UTC":"");switch(h){case D:return p?i(1,0):i(31,11);case M:return p?i(1,O):i(0,O+1);case q:var ae=this.$locale().weekStart||0,me=(z<ae?z+7:z)-ae;return i(p?Z-me:Z+(6-me),O);case U:case H:return L(re+"Hours",0);case j:return L(re+"Minutes",1);case t:return L(re+"Seconds",2);case A:return L(re+"Milliseconds",3);default:return this.clone()}},r.endOf=function(e){return this.startOf(e,!1)},r.$set=function(e,n){var o,p=$.p(e),h="set"+(this.$u?"UTC":""),i=(o={},o[U]=h+"Date",o[H]=h+"Date",o[M]=h+"Month",o[D]=h+"FullYear",o[j]=h+"Hours",o[t]=h+"Minutes",o[A]=h+"Seconds",o[B]=h+"Milliseconds",o)[p],L=p===U?this.$D+(n-this.$W):n;if(p===M||p===D){var z=this.clone().set(H,1);z.$d[i](L),z.init(),this.$d=z.set(H,Math.min(this.$D,z.daysInMonth())).$d}else i&&this.$d[i](L);return this.init(),this},r.set=function(e,n){return this.clone().$set(e,n)},r.get=function(e){return this[$.p(e)]()},r.add=function(e,n){var o,p=this;e=Number(e);var h=$.p(n),i=function(O){var Z=m(p);return $.w(Z.date(Z.date()+Math.round(O*e)),p)};if(h===M)return this.set(M,this.$M+e);if(h===D)return this.set(D,this.$y+e);if(h===U)return i(1);if(h===q)return i(7);var L=(o={},o[t]=v,o[j]=b,o[A]=V,o)[h]||1,z=this.$d.getTime()+e*L;return $.w(z,this)},r.subtract=function(e,n){return this.add(-1*e,n)},r.format=function(e){var n=this,o=this.$locale();if(!this.isValid())return o.invalidDate||P;var p=e||"YYYY-MM-DDTHH:mm:ssZ",h=$.z(this),i=this.$H,L=this.$m,z=this.$M,O=o.weekdays,Z=o.months,re=o.meridiem,ae=function(Q,oe,pe,ge){return Q&&(Q[oe]||Q(n,p))||pe[oe].slice(0,ge)},me=function(Q){return $.s(i%12||12,Q,"0")},le=re||function(Q,oe,pe){var ge=Q<12?"AM":"PM";return pe?ge.toLowerCase():ge};return p.replace(F,function(Q,oe){return oe||function(pe){switch(pe){case"YY":return String(n.$y).slice(-2);case"YYYY":return $.s(n.$y,4,"0");case"M":return z+1;case"MM":return $.s(z+1,2,"0");case"MMM":return ae(o.monthsShort,z,Z,3);case"MMMM":return ae(Z,z);case"D":return n.$D;case"DD":return $.s(n.$D,2,"0");case"d":return String(n.$W);case"dd":return ae(o.weekdaysMin,n.$W,O,2);case"ddd":return ae(o.weekdaysShort,n.$W,O,3);case"dddd":return O[n.$W];case"H":return String(i);case"HH":return $.s(i,2,"0");case"h":return me(1);case"hh":return me(2);case"a":return le(i,L,!0);case"A":return le(i,L,!1);case"m":return String(L);case"mm":return $.s(L,2,"0");case"s":return String(n.$s);case"ss":return $.s(n.$s,2,"0");case"SSS":return $.s(n.$ms,3,"0");case"Z":return h}return null}(Q)||h.replace(":","")})},r.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},r.diff=function(e,n,o){var p,h=this,i=$.p(n),L=m(e),z=(L.utcOffset()-this.utcOffset())*v,O=this-L,Z=function(){return $.m(h,L)};switch(i){case D:p=Z()/12;break;case M:p=Z();break;case X:p=Z()/3;break;case q:p=(O-z)/6048e5;break;case U:p=(O-z)/864e5;break;case j:p=O/b;break;case t:p=O/v;break;case A:p=O/V;break;default:p=O}return o?p:$.a(p)},r.daysInMonth=function(){return this.endOf(M).$D},r.$locale=function(){return S[this.$L]},r.locale=function(e,n){if(!e)return this.$L;var o=this.clone(),p=I(e,n,!0);return p&&(o.$L=p),o},r.clone=function(){return $.w(this.$d,this)},r.toDate=function(){return new Date(this.valueOf())},r.toJSON=function(){return this.isValid()?this.toISOString():null},r.toISOString=function(){return this.$d.toISOString()},r.toString=function(){return this.$d.toUTCString()},a}(),se=ne.prototype;return m.prototype=se,[["$ms",B],["$s",A],["$m",t],["$H",j],["$W",U],["$M",M],["$y",D],["$D",H]].forEach(function(a){se[a[1]]=function(r){return this.$g(r,a[0],a[1])}}),m.extend=function(a,r){return a.$i||(a(r,ne,m),a.$i=!0),m},m.locale=I,m.isDayjs=T,m.unix=function(a){return m(1e3*a)},m.en=S[_],m.Ls=S,m.p={},m})})(Ue);var _t=Ue.exports;const Se=Ze(_t),be=(s,y="YYYY-MM-DD HH:mm:ss")=>Se(s).isValid()?Se(s).format(y):s,Ct=s=>({year:"YYYY",years:"YYYY",month:"YYYY-MM",months:"YYYY-MM",date:"YYYY-MM-DD",dates:"YYYY-MM-DD",datetime:"YYYY-MM-DD HH:mm:ss",week:"YYYY-MM-DD",datetimerange:"YYYY-MM-DD HH:mm:ss",daterange:"YYYY-MM-DD",monthrange:"YYYY-MM",yearrange:"YYYY"})[s]??"YYYY-MM-DD",x=fe({props:{vNode:{type:[String,Number,Object],required:!0}},setup(s){return()=>s.vNode}}),Mt={class:"u-title-bar__title"},Yt={key:2,class:"u-title-bar__icon default-icon"},Dt={key:0,class:"u-title-bar__toolbar"},Ce=fe({name:"UTitleBar",inheritAttrs:!1,__name:"title-bar",props:{title:{default:""},icon:{default:""},iconClass:{},showIcon:{type:Boolean,default:!0}},setup(s){return(y,V)=>{const v=R("el-icon"),b=R("el-text");return l(),N("div",{class:we(["u-title-bar",y.$attrs.class]),style:Me(y.$attrs.style)},[ue("div",Mt,[y.showIcon?K(y.$slots,"icon",{key:0},()=>[y.icon?(l(),c(v,{key:0,class:"u-title-bar__icon"},{default:w(()=>[(l(),c(de(y.icon)))]),_:1})):y.iconClass?(l(),N("i",{key:1,class:we(["u-title-bar__icon",y.iconClass])},null,2)):(l(),N("i",Yt))]):E("",!0),W(b,{class:"u-title-bar__text",truncated:"",size:"large"},{default:w(()=>[K(y.$slots,"default",{},()=>[ie(_e(y.title),1)])]),_:3})]),y.$slots.toolbar?(l(),N("div",Dt,[K(y.$slots,"toolbar")])):E("",!0)],6)}}}),Ie=fe({name:"UForm",inheritAttrs:!1,__name:"form",props:Ye({view:{type:Boolean,default:!1},columns:{default:()=>({})},gutter:{default:20},rules:{},labelPosition:{default:"right"},requireAsteriskPosition:{default:"left"},labelWidth:{default:"auto"},labelSuffix:{default:""},inline:{type:Boolean,default:!1},inlineMessage:{type:Boolean,default:!1},statusIcon:{type:Boolean,default:!1},showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:{type:Boolean,default:!1},scrollToError:{type:Boolean,default:!1},scrollIntoViewOptions:{default:()=>({})},size:{default:"default"},disabled:{type:Boolean,default:!1}},{modelValue:{default:()=>({})},modelModifiers:{}}),emits:Ye(["validate","change"],["update:modelValue"]),setup(s,{expose:y,emit:V}){const v=V,b=Ke(s,"modelValue"),B=s,A=Re(),t=G(),j=ee(()=>ce(B,["view","rules","columns","modelValue"])),U=ee(()=>{const u=Number(B.gutter);if(u>0){const f=u/2;return{marginLeft:`${-f}px`,marginRight:`${-f}px`}}return{}}),q=(u,f,d)=>{v("validate",u,f,d)},M=(u,f)=>{v("change",u,f)},X=u=>typeof u.rendered=="function"?u.rendered(u):C(u.rendered)!==!1,D=u=>typeof u.display=="function"?u.display(u):C(u.display)!==!1,H=u=>ce(u,["span","element","value","attrs","if","show","style","slot"]),P=u=>{const f=["autocomplete","input","input-number","input-tag","mention"].includes(u.element),d=u.element?f?"请输入":"请选择":"请输入";return u.required&&!u.rules?[{required:!0,message:d}]:u.rules?u.rules.map(_=>({message:d,..._})):[]},k=(u,f)=>{var g;const d=(f==null?void 0:f.style)??{},_=((g=f.span)==null?void 0:g.split("/"))??[],S=Number(B.gutter);if(S>0){const T=S/2;d.paddingLeft=`${T}px`,d.paddingRight=`${T}px`}if(B.inline||(d.width="100%"),_.length===2){const T=parseInt(_[0]),I=parseInt(_[1]);T>0&&I>0&&T<=I?d.width=`${T/I*100}%`:console.warn(`表单项【${u}】的【span】属性配置错误，请检查配置; 正确格式如：1/2`)}return d},F=(u,f)=>{const d=b.value[u];if(d==null)return"";if(f.element==="cascader"){const{props:_={},options:S=[]}=f.attrs??{},g=gt(S,_.children);return ve(g,d,_)}else if(f.element==="transfer"){const{props:_={},data:S=[]}=f.attrs??{};return ve(S,d,{label:_.label,value:_.key??"key"})}else if(["select","checkbox-group","radio-group"].includes(f.element)){const{options:_=[]}=f.attrs;return ve(_,d)}else if(f.element==="switch"){const{activeText:_="是",inactiveText:S="否",activeValue:g=!0}=f.attrs??{};return d===g?_:S}else if(["time-picker","time-select"].includes(f.element)){const{format:_="HH:mm:ss"}=f.attrs??{};return Array.isArray(d)?d.map(S=>be(S,_)).join("-"):be(d,_)}else if(f.element==="date-picker"){const{type:_="date",format:S}=f.attrs??{};let g=Ct(_);return S&&(g=S),Array.isArray(d)?d.map(T=>be(T,g)).join("-"):be(d,g)}return(d==null?void 0:d.toString())??""};return y(new Proxy({},{get(u,f){var _;return(((_=A.refs)==null?void 0:_.formRef)??{})[f]},has(u,f){return t.value?Reflect.has(t.value,f):!1}})),(u,f)=>{const d=R("el-icon"),_=R("el-tooltip"),S=R("el-rate"),g=R("el-upload"),T=R("el-cascader"),I=R("el-button"),m=R("el-checkbox"),$=R("el-radio"),ne=R("el-option"),se=R("el-text"),a=R("el-form-item"),r=R("el-form");return C($e)(u.columns)?E("",!0):(l(),c(r,Y({key:0,class:"u-form",ref_key:"formRef",ref:t},j.value,{model:b.value,style:U.value,onValidate:q,class:u.$attrs.class}),{default:w(()=>[(l(!0),N(J,null,te(u.columns,(e,n)=>(l(),N(J,{key:n},[X(e)?Ve((l(),c(a,Y({key:0},H(e),{prop:n,rules:P(e),style:k(n,e),class:["u-form-item",e.element==="title-bar"?"u-form-item--title-bar":""],label:e.element==="title-bar"?"":e.label}),{label:w(o=>[u.$slots[`label-${n}`]?K(u.$slots,`label-${n}`,Y({key:0,item:e},o)):e.renderLabel?(l(),c(C(x),{key:1,"v-node":e.renderLabel({item:e,label:o.label})},null,8,["v-node"])):(l(),N(J,{key:2},[ie(_e(e.label)+" ",1),e.tooltip?(l(),c(_,{key:0,content:e.tooltip,placement:"top"},{default:w(()=>[K(u.$slots,"tooltip-icon",{},()=>[W(d,{class:"u-form-item__tooltip-icon"},{default:w(()=>[W(C(Qe))]),_:1})])]),_:2},1032,["content"])):E("",!0)],64))]),error:w(o=>[u.$slots[`error-${n}`]?K(u.$slots,`error-${n}`,Y({key:0,item:e},o)):e.renderError?(l(),c(C(x),{key:1,"v-node":e.renderError({item:e,error:o.error})},null,8,["v-node"])):E("",!0)]),default:w(()=>{var o,p,h;return[(u.view||e.view)&&e.element!=="title-bar"?(l(),N(J,{key:0},[e.formatter?(l(),c(C(x),{key:0,"v-node":e.formatter(e)},null,8,["v-node"])):e.element==="rate"?(l(),c(S,Y({key:1,modelValue:b.value[n],"onUpdate:modelValue":i=>b.value[n]=i},e.attrs,{disabled:!0}),null,16,["modelValue","onUpdate:modelValue"])):e.element==="upload"?(l(),c(g,Y({key:2,"file-list":b.value[n]},e.attrs,{disabled:!0,class:"is-view"}),null,16,["file-list"])):(l(),c(C(x),{key:3,"v-node":F(n,e)},null,8,["v-node"]))],64)):u.$slots[n]?K(u.$slots,n,{key:1,item:e}):e.render?(l(),c(C(x),{key:2,"v-node":e.render({item:e,view:u.view})},null,8,["v-node"])):e.component?(l(),c(de(e.component),Y({key:3,modelValue:b.value[n],"onUpdate:modelValue":i=>b.value[n]=i},e.attrs,{view:u.view,onChange:i=>M(n,e)}),null,16,["modelValue","onUpdate:modelValue","view","onChange"])):e.element?(l(),N(J,{key:4},[e.element==="title-bar"?(l(),c(Ce,Y({key:0,title:e.label},e.attrs),he({_:2},[(o=e.attrs)!=null&&o.renderIcon?{name:"icon",fn:w(()=>[W(C(x),{"v-node":e.attrs.renderIcon()},null,8,["v-node"])]),key:"0"}:void 0,(p=e.attrs)!=null&&p.renderToolbar?{name:"toolbar",fn:w(()=>[W(C(x),{"v-node":e.attrs.renderToolbar()},null,8,["v-node"])]),key:"1"}:void 0,(h=e.attrs)!=null&&h.render?{name:"default",fn:w(()=>[W(C(x),{"v-node":e.attrs.render()},null,8,["v-node"])]),key:"2"}:void 0]),1040,["title"])):e.element==="cascader"?(l(),c(T,Y({key:1,modelValue:b.value[n],"onUpdate:modelValue":i=>b.value[n]=i},e.attrs,{onChange:i=>M(n,e)}),null,16,["modelValue","onUpdate:modelValue","onChange"])):e.element==="upload"?(l(),c(g,Y({key:2,"file-list":b.value[n],"onUpdate:fileList":i=>b.value[n]=i},e.attrs,{onChange:i=>M(n,e)}),{default:w(()=>{var i;return[((i=e.attrs)==null?void 0:i.listType)!=="picture-card"?(l(),c(I,{key:0,type:"primary"},{default:w(()=>[ie(" 点击上传 ")]),_:1})):E("",!0)]}),_:2},1040,["file-list","onUpdate:fileList","onChange"])):e.element==="checkbox"?(l(),c(m,Y({key:3,modelValue:b.value[n],"onUpdate:modelValue":i=>b.value[n]=i},e.attrs,{onChange:i=>M(n,e)}),null,16,["modelValue","onUpdate:modelValue","onChange"])):e.element==="radio"?(l(),c($,Y({key:4,modelValue:b.value[n],"onUpdate:modelValue":i=>b.value[n]=i},e.attrs,{onChange:i=>M(n,e)}),null,16,["modelValue","onUpdate:modelValue","onChange"])):(l(),c(de(`el-${e.element}`),Y({key:5,modelValue:b.value[n],"onUpdate:modelValue":i=>b.value[n]=i},e.attrs,{onChange:i=>M(n,e)}),{default:w(()=>[e.attrs&&e.attrs.options?(l(),N(J,{key:0},[e.element==="select"?(l(!0),N(J,{key:0},te(e.attrs.options,i=>(l(),c(ne,Y({key:i.value},i),null,16))),128)):e.element==="checkbox-group"?(l(!0),N(J,{key:1},te(e.attrs.options,i=>(l(),c(m,Y({key:i.value},i),null,16))),128)):e.element==="radio-group"?(l(!0),N(J,{key:2},te(e.attrs.options,i=>(l(),c($,Y({key:i.value},i),null,16))),128)):E("",!0)],64)):E("",!0)]),_:2},1040,["modelValue","onUpdate:modelValue","onChange"]))],64)):(l(),c(se,{key:5,type:"danger"},{default:w(()=>[ie(_e(`请检查表单项【${n}】的配置`),1)]),_:2},1024))]}),_:2},1040,["prop","rules","style","class","label"])),[[Oe,D(e)]]):E("",!0)],64))),128)),u.inline?(l(),c(a,{key:0,class:"u-form-item--searchbar",style:Me(k("_searchbar",{}))},{default:w(()=>[K(u.$slots,"searchbar")]),_:3},8,["style"])):E("",!0)]),_:3},16,["model","style","class"]))}}}),He=Ie;He.install=s=>{s.component("UForm",Ie)};const St=s=>({getElTableColumnAttrs:ee(()=>ce(s.item,["children","formatter","render","component","rendered","element","rules","attrs","renderHeader"])),getFormItemRules:v=>v.required?[{required:!0,message:"请输入"}]:v.rules?v.rules.map(b=>({message:"请输入",...b})):[]}),Tt=fe({__name:"table-column",props:{item:{},editable:{type:Boolean}},emits:["click-operation"],setup(s,{emit:y}){const V=s,v=y,{getElTableColumnAttrs:b,getFormItemRules:B}=St(V),A=ee(()=>{const{prop:t,rendered:j=!0,show:U=!0}=V.item;return typeof j=="function"?t&&j(V.item)&&U:t&&j&&U});return(t,j)=>{const U=R("TableColumn",!0),q=R("el-cascader"),M=R("el-checkbox"),X=R("el-radio"),D=R("el-option"),H=R("el-form-item"),P=R("el-table-column");return A.value?(l(),c(P,ye(Y({key:0},C(b))),{header:w(k=>[t.$slots[`header-${t.item.prop}`]?K(t.$slots,`header-${t.item.prop}`,Y({key:0},k,{item:t.item})):t.item.renderHeader?(l(),c(C(x),{key:1,"v-node":t.item.renderHeader({...k,item:t.item})},null,8,["v-node"])):E("",!0)]),"filter-icon":w(k=>[t.$slots[`filter-icon-${t.item.prop}`]?K(t.$slots,`filter-icon-${t.item.prop}`,Y({key:0},k,{item:t.item})):t.item.renderFilterIcon?(l(),c(C(x),{key:1,"v-node":t.item.renderFilterIcon({...k,item:t.item})},null,8,["v-node"])):E("",!0)]),default:w(k=>[t.item.children?(l(!0),N(J,{key:0},te(t.item.children,F=>(l(),c(U,{key:F.prop,item:F,editable:t.editable},he({_:2},[te(Object.keys(t.$slots),u=>({name:u,fn:w(f=>[K(t.$slots,u,ye(ke(f)))])}))]),1032,["item","editable"]))),128)):k.$index>-1&&t.editable&&t.item.element?(l(),c(H,{key:1,prop:`${k.$index}.${t.item.prop}`,rules:C(B)(t.item)},{default:w(()=>[t.item.element==="cascader"?(l(),c(q,Y({key:0,modelValue:k.row[t.item.prop],"onUpdate:modelValue":F=>k.row[t.item.prop]=F},t.item.attrs),null,16,["modelValue","onUpdate:modelValue"])):t.item.element==="checkbox"?(l(),c(M,Y({key:1,modelValue:k.row[t.item.prop],"onUpdate:modelValue":F=>k.row[t.item.prop]=F},t.item.attrs),null,16,["modelValue","onUpdate:modelValue"])):t.item.element==="radio"?(l(),c(X,Y({key:2,modelValue:k.row[t.item.prop],"onUpdate:modelValue":F=>k.row[t.item.prop]=F},t.item.attrs),null,16,["modelValue","onUpdate:modelValue"])):(l(),c(de(`el-${t.item.element}`),Y({key:3,modelValue:k.row[t.item.prop],"onUpdate:modelValue":F=>k.row[t.item.prop]=F},t.item.attrs),{default:w(()=>{var F,u,f;return[t.item.element==="select"?(l(!0),N(J,{key:0},te(((F=t.item.attrs)==null?void 0:F.options)??[],d=>(l(),c(D,Y({key:d.value},d),null,16))),128)):t.item.element==="checkbox-group"?(l(!0),N(J,{key:1},te(((u=t.item.attrs)==null?void 0:u.options)??[],d=>(l(),c(M,Y({key:d.value},d),null,16))),128)):t.item.element==="radio-group"?(l(!0),N(J,{key:2},te(((f=t.item.attrs)==null?void 0:f.options)??[],d=>(l(),c(X,Y({key:d.value},d),null,16))),128)):E("",!0)]}),_:2},1040,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["prop","rules"])):t.$slots[t.item.prop]?K(t.$slots,t.item.prop,Y({key:2},k,{item:t.item})):t.item.component?(l(),N(J,{key:3},[t.item.component==="operation"?(l(),c(nt,Y({key:0,slotProps:k,item:t.item},t.item.attrs,{onClickOperation:j[0]||(j[0]=(...F)=>v("click-operation",...F))}),null,16,["slotProps","item"])):(l(),c(de(t.item.component),Y({key:1,slotProps:k,item:t.item},t.item.attrs),null,16,["slotProps","item"]))],64)):t.item.formatter?(l(),c(C(x),{key:4,"v-node":t.item.formatter({...k,item:t.item})},null,8,["v-node"])):E("",!0)]),_:3},16)):E("",!0)}}}),Vt=(s,y)=>{const V=G(),v=G([]),b=G(!1),B=G([]),A=ee(()=>Array.isArray(s.toolbar)?s.toolbar.length>0:s.toolbar),t=ee(()=>Array.isArray(s.toolbar)?s.toolbar.includes("refresh"):s.toolbar===!0),j=ee(()=>Array.isArray(s.toolbar)?s.toolbar.includes("fullscreen"):s.toolbar===!0),U=ee(()=>Array.isArray(s.toolbar)?s.toolbar.includes("setting"):s.toolbar===!0),q=()=>{y("refresh")},M=G(),{isFullscreen:X,toggleFullscreen:D}=ft(M),H=ee(()=>{let g=0;const T=I=>{I.forEach(m=>{g++,$e(m.children)||T(m.children)})};return T(v.value),g}),P=(g,T,I)=>(T.forEach(m=>{Be(I)||(m.show=I);const{rendered:$=!0,show:ne=!0}=m;typeof $=="function"?$(m)&&ne&&g.push(m.prop):$&&ne&&g.push(m.prop),m.children&&P(g,m.children,I)}),g),k=g=>{var I;const T=P([],v.value,g);(I=V.value)==null||I.setCheckedKeys(T)},F=(g,T,I)=>{!$e(g.children)&&I?g.show=!0:g.show=T;const m=V.value.getCheckedNodes().length||0;f.value=m<H.value&&m!==0,u.value=m===H.value},u=G(!0),f=G(!1),d=()=>{k(u.value)},_=(g,T,I)=>{if(I==="inner")return!1;const m=g.parent,$=T.parent;return m===$},S=()=>{v.value=De(B.value)};return qe(()=>s.columns,g=>{$e(g)||(B.value=De(g),b.value=!0),v.value=g},{immediate:!0}),{_columns:v,showToolbar:A,showRefresh:t,showFullscreen:j,showSetting:U,uTableRef:M,handleRefresh:q,isFullscreen:X,toggleFullscreen:D,treeRef:V,setCheckedKeys:k,checkedAll:u,checkedIndeterminate:f,handleChangeCheckedAll:d,handleResetColumns:S,handleCheckChange:F,allowDrop:_}},Ot={class:"u-table-setting"},Rt={class:"u-table-setting-header"},Ee=fe({name:"UTable",__name:"table",props:{columns:{},editable:{type:Boolean,default:!1},showSelection:{type:Boolean,default:!1},selectionProps:{default:()=>({})},showIndex:{type:Boolean,default:!1},indexProps:{default:()=>({})},showExpand:{type:Boolean,default:!1},expandProps:{default:()=>({})},showTitleBar:{type:Boolean,default:!0},title:{},toolbar:{type:[Boolean,Array],default:!0},data:{},size:{},width:{},height:{},maxHeight:{},fit:{type:Boolean,default:!0},stripe:{type:Boolean,default:!1},border:{type:Boolean,default:!1},rowKey:{},context:{},showHeader:{type:Boolean,default:!0},showSummary:{type:Boolean,default:!1},sumText:{},summaryMethod:{},rowClassName:{},rowStyle:{},cellClassName:{},cellStyle:{},headerRowClassName:{},headerRowStyle:{},headerCellClassName:{},headerCellStyle:{},highlightCurrentRow:{type:Boolean,default:!1},currentRowKey:{},emptyText:{},expandRowKeys:{},defaultExpandAll:{type:Boolean,default:!1},defaultSort:{},tooltipEffect:{},tooltipOptions:{},spanMethod:{},selectOnIndeterminate:{type:Boolean,default:!0},indent:{},treeProps:{},lazy:{type:Boolean,default:!1},load:{},className:{},style:{},tableLayout:{},scrollbarAlwaysOn:{type:Boolean,default:!1},flexible:{type:Boolean,default:!1},showOverflowTooltip:{type:[Boolean,Object],default:!1},tooltipFormatter:{},appendFilterPanelTo:{},scrollbarTabindex:{}},emits:["click-operation","refresh"],setup(s,{expose:y,emit:V}){const v=s,b=V,B=Re(),A=G(),t=G(),j=ee(()=>ce(v.indexProps,["formatter","renderHeader"])),U=ee(()=>ce(v.selectionProps,["formatter","renderHeader"])),q=Je(),M=ee(()=>{const a=Object.keys(v).filter(r=>Be(v[r]));return a.push("columns","editable"),ce({...v,...q},a)}),X=(a,r,e)=>{b("click-operation",a,r,e)},{_columns:D,showToolbar:H,showRefresh:P,showFullscreen:k,showSetting:F,uTableRef:u,handleRefresh:f,isFullscreen:d,toggleFullscreen:_,treeRef:S,setCheckedKeys:g,checkedAll:T,checkedIndeterminate:I,handleChangeCheckedAll:m,handleResetColumns:$,handleCheckChange:ne,allowDrop:se}=Vt(v,b);return y(new Proxy({},{get(a,r){var n;return r==="validate"?t.value.validate:r==="validateField"?t.value.validateField:r==="scrollToField"?t.value.scrollToField:r==="resetFields"?t.value.resetFields:r==="clearValidate"?t.value.clearValidate:(((n=B.refs)==null?void 0:n.tableRef)??{})[r]},has(a,r){return Reflect.has(A.value,r)||Reflect.has(t.value,r)}})),(a,r)=>{const e=R("el-button"),n=R("el-tooltip"),o=R("el-checkbox"),p=R("el-tree"),h=R("el-popover"),i=R("el-table-column"),L=R("el-table"),z=R("el-form");return l(),N("div",{class:we(["u-table",{"is-fullscreen":C(d)}]),ref_key:"uTableRef",ref:u},[a.showTitleBar?(l(),c(Ce,{key:0,title:a.title,"show-icon":!1},{default:w(()=>[K(a.$slots,"title")]),toolbar:w(()=>[K(a.$slots,"toolbar"),C(H)?(l(),N(J,{key:0},[C(P)?(l(),c(n,{key:0,content:"刷新",placement:"top",teleported:!1},{default:w(()=>[W(e,{circle:"",icon:C(xe),onClick:C(f)},null,8,["icon","onClick"])]),_:1})):E("",!0),C(k)?(l(),c(n,{key:1,content:C(d)?"退出全屏":"全屏",placement:"top",teleported:!1},{default:w(()=>[W(e,{circle:"",icon:C(et),onClick:r[0]||(r[0]=O=>C(_)())},null,8,["icon"])]),_:1},8,["content"])):E("",!0),C(F)?(l(),c(n,{key:2,content:"设置",placement:"top",teleported:!1},{default:w(()=>[W(e,{circle:""},{default:w(()=>[W(h,{placement:"bottom-end",trigger:"click",onBeforeEnter:r[2]||(r[2]=O=>C(g)()),"popper-class":"u-table-setting-popper",teleported:!1},{reference:w(()=>[W(e,{circle:"",icon:C(tt)},null,8,["icon"])]),default:w(()=>[ue("div",Ot,[ue("div",Rt,[W(o,{modelValue:C(T),"onUpdate:modelValue":r[1]||(r[1]=O=>Xe(T)?T.value=O:null),onChange:C(m),indeterminate:C(I)},{default:w(()=>[ie("全选")]),_:1},8,["modelValue","onChange","indeterminate"]),W(e,{type:"primary",link:"",onClick:C($)},{default:w(()=>[ie("重置")]),_:1},8,["onClick"])]),W(p,{ref_key:"treeRef",ref:S,data:C(D),"node-key":"prop","show-checkbox":"",draggable:"","allow-drop":C(se),onCheckChange:C(ne)},null,8,["data","allow-drop","onCheckChange"])])]),_:1})]),_:1})]),_:1})):E("",!0)],64)):E("",!0)]),_:3},8,["title"])):E("",!0),W(z,{ref_key:"formRef",ref:t,model:a.data,"show-message":!1},{default:w(()=>[W(L,Y({ref_key:"tableRef",ref:A},M.value),he({default:w(()=>[a.showExpand?(l(),c(i,Y({key:0,type:"expand"},a.expandProps),{default:w(O=>[K(a.$slots,"expand",ye(ke(O)))]),_:3},16)):E("",!0),a.showIndex?(l(),c(i,Y({key:1,type:"index"},j.value),he({_:2},[a.indexProps.renderHeader?{name:"header",fn:w(O=>[W(C(x),{"v-node":a.indexProps.renderHeader(O)},null,8,["v-node"])]),key:"0"}:void 0,a.indexProps.formatter?{name:"default",fn:w(O=>[W(C(x),{"v-node":a.indexProps.formatter(O)},null,8,["v-node"])]),key:"1"}:void 0]),1040)):E("",!0),a.showSelection?(l(),c(i,Y({key:2,type:"selection"},U.value),null,16)):E("",!0),(l(!0),N(J,null,te(C(D),O=>(l(),c(Tt,{key:O.prop,item:O,editable:a.editable,onClickOperation:X},he({_:2},[te(Object.keys(a.$slots),Z=>({name:Z,fn:w(re=>[K(a.$slots,Z,ye(ke(re)))])}))]),1032,["item","editable"]))),128))]),_:2},[a.$slots.empty?{name:"empty",fn:w(()=>[K(a.$slots,"empty")]),key:"0"}:void 0,a.$slots.append?{name:"append",fn:w(O=>[K(a.$slots,"append",ye(ke(O)))]),key:"1"}:void 0]),1040)]),_:3},8,["model"])],2)}}}),Ne=Ee;Ne.install=s=>{s.component("UTable",Ee)};const je=Ce;je.install=s=>{s.component("UTitleBar",Ce)};const Wt=(s,y={})=>{const{auto:V=!0,isShallow:v=!0,defaultFormData:b={},defaultPageSize:B=10}=y,A=G(!1),t=G({pageNum:1,pageSize:B,total:0}),{formRef:j,formData:U,formOptions:q,setFormOptions:M,updateFormItemOption:X,getFormData:D}=mt(()=>b,!1);D();const{tableRef:H,tableData:P,tableColumns:k,tableOperations:F,multipleSelection:u,handleSelectionChange:f,toggleTableColumnRendered:d,setTableColumns:_,setTableOperations:S}=pt(()=>[],{auto:!1,isShallow:v}),g=async()=>{A.value=!0;const m={...U.value,pageNum:t.value.pageNum,pageSize:t.value.pageSize},$=await s(m);P.value=$.rows,t.value.total=$.total},T=async m=>{t.value.pageNum=1,U.value={...U.value,...m},await g()},I=async m=>{t.value.pageNum=1,U.value={...b,...m},await g()};return Te(()=>{V&&g()}),{loading:A,formRef:j,formData:U,formOptions:q,setFormOptions:M,updateFormItemOption:X,tableRef:H,tableData:P,tableColumns:k,tableOperations:F,multipleSelection:u,handleSelectionChange:f,toggleTableColumnRendered:d,setTableColumns:_,setTableOperations:S,pagerParams:t,fetchData:g,query:T,reset:I}},Bt=[He,Ne,Fe,rt,je],At=s=>{Bt.forEach(y=>{s.component(y.name,y)})},Kt={install:At};export{Fe as UContextMenu,He as UForm,rt as UOperation,Ne as UTable,je as UTitleBar,Kt as default,At as install,mt as useForm,ft as useFullscreen,Wt as usePage,pt as useTable};
